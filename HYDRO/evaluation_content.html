<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Évaluation FFESSM - Niveau 2</title>
  <style>
    body { font-family: Arial, sans-serif; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    td.state-A { background-color: #b6f1c2; }
    td.state-ECA { background-color: #f9b5b5; }
    td.state-NT { background-color: #ddd; }
    td.label-left { text-align: left; font-weight: bold; color: #004466; background: #e0e0e0; }
    .pe40-header { background-color: #0F4166; color: white; font-weight: bold; text-align: left; padding-left: 10px; }
    .commune-header { background-color: #546B8D; color: white; font-weight: bold; text-align: left; padding-left: 10px; }
    .pa20-header { background-color: #B1B8CB; color: black; font-weight: bold; text-align: left; padding-left: 10px; }
    textarea { width: 98%; height: 4em; resize: vertical; }
    select { font-size: 0.9em; }
    td[data-ipdcell] { cursor: pointer; text-decoration: underline; color: darkblue; }
  </style>
</head>
<body>
<h2>Évaluation Niveau 2 - FFESSM</h2>
<br>
<label for="eleveSelect">Élève :</label>
<select id="eleveSelect">
  <option>-- Choisir un élève --</option>
  <option>AINS Mathieu</option>
  <option>BARTHELEMY Carole</option>
  <option>BRAOUDE Dominique</option>
  <option>DE VITI Gaétan</option>
  <option>EISNITZ Anne-Laure</option>
  <option>EHRHARD Virginie</option>
  <option>LEPARMENTIER Damien</option>
  <option>MORGAND Claire</option>
  <option>OPIN Maxime</option>
  <option>OURSEL Oxana</option>
  <option>PINHEIRO Tony</option>
  <option>RONDET Célian</option>
</select>
<br><br>
<br>
<table id="evaluationTable">
  <tr>
    <th>Compétence</th>
    <th>Plongée #1</th>
<th>Plongée #2</th>
<th>Plongée #3</th>
<th>Plongée #4</th>
<th>Plongée #5</th>
<th>Plongée #6</th>
<th>Plongée #7</th>
  </tr>
  <tr class="date-row">
    <td>Date</td>
    <td><input type="date"></td>
<td><input type="date"></td>
<td><input type="date"></td>
<td><input type="date"></td>
<td><input type="date"></td>
<td><input type="date"></td>
<td><input type="date"></td>
  </tr>
  <tr class="evaluateur-row">
    <td>Évaluateur</td>
    <td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
<td><select>
      <option>--</option>
      <option>POUJOL Jérémie (E3)</option>
      <option>VELLUET Philippe (E3)</option>
      <option>COATMEUR Cyrille (E3)</option>
      <option>BEURY Didier (E2)</option>
      <option>BONNET Jean-Philippe (E2)</option>
      <option>BRILL Nicolas (E2)</option>
      <option>GARNIER Laurent (E2)</option>
      <option>MERCIER-GALLAY Jacques (E2)</option>
      <option>MERLE Arthur (E2)</option>
    </select></td>
  </tr>
  <tr><td colspan="8" class="pe40-header">Compétences spécifiques — PE40</td></tr>
<tr><td class='label-left'>Ventilation & consommation</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Propulsion & équilibrage</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Communication avec GP</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Intervenir en relai sur un équipier en difficulté</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td colspan="8" class="commune-header">Compétences communes —</td></tr>
<tr><td class='label-left'>Lestage adapté</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>S’équiper & mise à l’eau</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Immersion & propulsion</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Respect du milieu</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Vidage de masque</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Retour surface (cohésion de la palanquée & vitesse)</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Respect durée & profondeur annoncées par le DP</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td colspan="8" class="pa20-header">Compétences spécifiques — PA20</td></tr>
<tr><td class='label-left'>Planifier la plongée (sur le bateau)</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Vérif matériel équipiers (buddy check)</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Autonomie (Orientation)</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Autonomie (Conso & Déco)</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Parachute</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td><td class='state-NT' onclick='toggleState(this)' data-state='NT'>NT</td></tr>
<tr><td class='label-left'>Intervenir et porter assistance (IPD1)</td>
  <td class='state-NT' data-ipdcell='IPD1_P1' onclick='ouvrirModalIPD("IPD1_P1")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P2' onclick='ouvrirModalIPD("IPD1_P2")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P3' onclick='ouvrirModalIPD("IPD1_P3")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P4' onclick='ouvrirModalIPD("IPD1_P4")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P5' onclick='ouvrirModalIPD("IPD1_P5")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P6' onclick='ouvrirModalIPD("IPD1_P6")'>⚙️ Évaluer IPD1</td>
  <td class='state-NT' data-ipdcell='IPD1_P7' onclick='ouvrirModalIPD("IPD1_P7")'>⚙️ Évaluer IPD1</td>
</tr>

<tr><td class='label-left'>Intervenir et porter assistance (IPD2)</td>
  <td class='state-NT' data-ipdcell='IPD2_P1' onclick='ouvrirModalIPD("IPD2_P1")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P2' onclick='ouvrirModalIPD("IPD2_P2")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P3' onclick='ouvrirModalIPD("IPD2_P3")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P4' onclick='ouvrirModalIPD("IPD2_P4")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P5' onclick='ouvrirModalIPD("IPD2_P5")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P6' onclick='ouvrirModalIPD("IPD2_P6")'>⚙️ Évaluer IPD2</td>
  <td class='state-NT' data-ipdcell='IPD2_P7' onclick='ouvrirModalIPD("IPD2_P7")'>⚙️ Évaluer IPD2</td>
</tr>

<tr><td class='label-left'>Remarques</td>
<td><textarea></textarea></td><td><textarea></textarea></td><td><textarea></textarea></td><td><textarea></textarea></td><td><textarea></textarea></td><td><textarea></textarea></td><td><textarea></textarea></td>
</tr>
</table>

<script>
function toggleState(cell) {
  const states = ["NT", "ECA", "A"];
  let current = cell.getAttribute("data-state") || "NT";
  let index = states.indexOf(current);
  let next = states[(index + 1) % states.length];
  cell.setAttribute("data-state", next);
  cell.className = "state-" + next;
  cell.innerText = next;
}
function toggleIPDModal(ref) {
  alert("Grille d'évaluation IPD à implémenter pour " + ref);
}
function ouvrirModalIPD(nomIPD) {
  const criteres = [
    { nom: "Interprétation du signe et comportement adapté", poids: 2 },
    { nom: "Vitesse de réaction", poids: 4 },
    { nom: "Communication décollage", poids: 2 },
    { nom: "Prise sécurisante", poids: 2 },
    { nom: "Rectitude & vitesse de remontée", poids: 4 },
    { nom: "Décollage tonique", poids: 2 },
    { nom: "Stop franc entre 5m et 3m", poids: 1 },
    { nom: "Tour d'horizon", poids: 1 },
    { nom: "Regard & présence lors de la remontée", poids: 1 },
    { nom: "Ralentissement marqué à 5m", poids: 1 }
  ];
  let html = `<h3>Détail de l’évaluation : ${nomIPD}</h3><form id='form_${nomIPD}'>`;
  criteres.forEach((crit, idx) => {
    html += `<label>${crit.nom} (sur ${crit.poids} pts)</label><br>`;
    html += `<input type='number' name='crit_${idx}' min='0' max='${crit.poids}' required><br><br>`;
  });
  html += `<button type='submit'>✅ Valider</button>`;
  html += `</form>`;

  const modal = document.getElementById("modalIPD");
  modal.querySelector(".modal-content").innerHTML = html;
  modal.style.display = "flex";

  document.getElementById(`form_${nomIPD}`).onsubmit = (e) => {
    e.preventDefault();
    const inputs = e.target.querySelectorAll("input");
    let total = 0;
    inputs.forEach((input) => {
      total += parseFloat(input.value || 0);
    });
    alert(`Total IPD évalué : ${total}/20`);
    modal.style.display = "none";
  };
}

window.onclick = function(event) {
  const modal = document.getElementById("modalIPD");
  if (event.target === modal) modal.style.display = "none";
};
</script>

<div id="modalIPD" class="modal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center;">
  <div class="modal-content" style="background: white; padding: 20px; max-width: 500px; border-radius: 8px;"></div>
</div>


</body>
</html>
